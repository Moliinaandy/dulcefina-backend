<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirmación de Pedido - Dulcefina</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 0; background-color: #f8f9fa; }
        .email-wrapper { background-color: #ffffff; max-width: 600px; margin: 20px auto; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden; }
        .header { background-color: #f8c0cb; padding: 20px; text-align: center; color: #fff; }
        .content { padding: 30px; }
        .order-details, .shipping-details { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px dashed #eee; }
        .order-details h3, .shipping-details h3 { margin-top: 0; color: #E11D48; font-size: 1.1em; }
        .item-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .item-table th, .item-table td { border-bottom: 1px solid #eee; padding: 8px 4px; text-align: left; font-size: 0.9em; }
        .item-table th { background-color: #f8f9fa; font-weight: bold; }
        .item-table td.price { text-align: right; }
        .total-row { font-weight: bold; font-size: 1.1em; border-top: 2px solid #333; }
        .footer { margin-top: 30px; padding: 0; border-top: 1px solid #eee; text-align: center; font-size: 12px; color: #6c757d; background-color: #f8f9fa; }
        .footer img { display: block; width: 100%; max-width: 100%; height: auto; border-bottom: 1px solid #eee; }
        .footer-text { padding: 15px; }
        a { color: #E11D48; text-decoration: none; }
    </style>
</head>
<body>
<div class="email-wrapper">
    <div class="header">
        <h1>¡Gracias por tu pedido!</h1>
    </div>
    <div class="content">
        <h2>Hola <span th:text="${customerName}">Cliente</span>,</h2>
        <p>Hemos recibido tu pedido y ya estamos trabajando en él. Aquí tienes un resumen:</p>

        <div class="order-details">
            <h3>Detalles del Pedido</h3>
            <p><strong>Número de Pedido:</strong> #<span th:text="${order.orderId}">000</span></p>
            <p><strong>Fecha del Pedido:</strong> <span th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}">Fecha</span></p>
            <p><strong>Estado:</strong> <span th:text="${order.status}">Pendiente</span></p>
            <p><strong>Método de Pago:</strong> <span th:text="${order.paymentMethod}">Método</span></p>
        </div>

        <div class="shipping-details">
            <h3>Información de Envío</h3>
            <p><strong>Nombre:</strong> <span th:text="${order.customerName}">Nombre Cliente</span></p>
            <p><strong>Dirección:</strong> <span th:text="${order.shippingAddress}">Dirección</span></p>
            <p><strong>Teléfono:</strong> <span th:text="${order.customerPhone}">Teléfono</span></p>
        </div>

        <div>
            <h3>Productos</h3>
            <table class="item-table">
                <thead>
                <tr>
                    <th>Producto</th>
                    <th>Cantidad</th>
                    <th class="price">Precio Unit.</th>
                    <th class="price">Subtotal</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="item : ${order.items}">
                    <td>
                        <span th:text="${item.productName}">Nombre Producto</span>
                        <div th:if="${item.customization}" style="font-size: 0.8em; color: #555;">
                            (Personalizado) </div>
                    </td>
                    <td th:text="${item.quantity}">1</td>
                    <td class="price" th:text="'S/ ' + ${#numbers.formatDecimal(item.unitPrice, 1, 'COMMA', 2, 'POINT')}">S/ 0.00</td>
                    <td class="price" th:text="'S/ ' + ${#numbers.formatDecimal(item.subtotal, 1, 'COMMA', 2, 'POINT')}">S/ 0.00</td>
                </tr>
                <tr class="total-row">
                    <td colspan="3" style="text-align: right;"><strong>Total:</strong></td>
                    <td class="price" th:text="'S/ ' + ${#numbers.formatDecimal(order.totalPrice, 1, 'COMMA', 2, 'POINT')}">S/ 0.00</td>
                </tr>
                </tbody>
            </table>
        </div>

        <p style="margin-top: 25px;">Pronto te notificaremos cuando tu pedido esté en camino.</p>
        <p>¡Gracias por elegir Dulcefina!</p>
    </div>
    <div class="footer">
        <img src="cid:logoDulcefina" alt="Dulcefina Banner"/>
        <div class="footer-text">
            &copy; <span th:text="${currentYear}">2025</span> Dulcefina. Todos los derechos reservados.<br/>
        </div>
    </div>
</div>
</body>
</html>